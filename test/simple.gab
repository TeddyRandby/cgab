'std/HTTP':require
'fiber':require

status, server = :http(8001) in match
  .ok => 
    for client in server:serve
      :fiber do
        'std/HTTP':require
        'socket':require

        s, buf = client:recv
          
        s == .ok else
          s:print
        end

        def res = :res                     in
          :status(200)                     in
          :html('<div>Hello, World!</div>')
          
        s = client:send(res)
          
        s == .ok else
          s:print
        end
      end
    end
  end

  else => status:print end
