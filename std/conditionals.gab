:use .records

def match[](cases, fallback?)
  case = cases:next

  loop
    case == self then
      branch = cases[case]

      return branch(self)

      break .INVALID_ARGUMENTS:panic
    end

    case = cases:next(case)
  until not case end

  fallback? or 'MISSING_CASE: {self}':panic

  fallback?(self)
end
